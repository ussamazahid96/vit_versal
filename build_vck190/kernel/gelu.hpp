#include <ap_int.h>
#include <hls_stream.h>
#include <ap_axi_sdata.h>
#include "hls_math.h"

#define EMB_DIM 3072
#define TOKENS_PADDED 256
#define TOKENS 197
#define AXI_WIDTH 512
#define DATA_TYPE 32

typedef float datatype;

void gelu(ap_uint<AXI_WIDTH> *in, ap_uint<AXI_WIDTH> *out, int batch);

const float delta[256] =  {
		0.00000000,
		0.00582714,
		0.01154386,
		0.01715021,
		0.02264627,
		0.02803214,
		0.03330796,
		0.03847390,
		0.04353015,
		0.04847695,
		0.05331454,
		0.05804323,
		0.06266333,
		0.06717518,
		0.07157916,
		0.07587567,
		0.08006515,
		0.08414806,
		0.08812489,
		0.09199615,
		0.09576240,
		0.09942421,
		0.10298218,
		0.10643694,
		0.10978912,
		0.11303940,
		0.11618853,
		0.11923720,
		0.12218614,
		0.12503618,
		0.12778810,
		0.13044271,
		0.13300087,
		0.13546342,
		0.13783130,
		0.14010540,
		0.14228663,
		0.14437595,
		0.14637434,
		0.14828280,
		0.15010232,
		0.15183392,
		0.15347865,
		0.15503758,
		0.15651175,
		0.15790233,
		0.15921032,
		0.16043690,
		0.16158321,
		0.16265035,
		0.16363952,
		0.16455188,
		0.16538858,
		0.16615087,
		0.16683987,
		0.16745684,
		0.16800299,
		0.16847956,
		0.16888779,
		0.16922879,
		0.16950399,
		0.16971451,
		0.16986167,
		0.16994673,
		0.16997087,
		0.16993552,
		0.16984177,
		0.16969091,
		0.16948432,
		0.16922319,
		0.16890877,
		0.16854233,
		0.16812527,
		0.16765863,
		0.16714382,
		0.16658199,
		0.16597462,
		0.16532266,
		0.16462761,
		0.16389048,
		0.16311264,
		0.16229534,
		0.16143978,
		0.16054708,
		0.15961850,
		0.15865529,
		0.15765852,
		0.15662950,
		0.15556931,
		0.15447909,
		0.15336007,
		0.15221334,
		0.15104002,
		0.14984125,
		0.14861810,
		0.14737171,
		0.14610308,
		0.14481330,
		0.14350343,
		0.14217448,
		0.14082754,
		0.13946366,
		0.13808358,
		0.13668847,
		0.13527942,
		0.13385713,
		0.13242257,
		0.13097692,
		0.12952065,
		0.12805510,
		0.12658083,
		0.12509871,
		0.12360966,
		0.12211466,
		0.12061417,
		0.11910927,
		0.11760044,
		0.11608875,
		0.11457479,
		0.11305928,
		0.11154306,
		0.11002648,
		0.10851061,
		0.10699582,
		0.10548294,
		0.10397243,
		0.10246491,
		0.10096121,
		0.09946156,
		0.09796667,
		0.09647703,
		0.09499335,
		0.09351587,
		0.09204531,
		0.09058189,
		0.08912635,
		0.08767891,
		0.08623993,
		0.08481014,
		0.08338964,
		0.08197904,
		0.08057845,
		0.07918847,
		0.07780921,
		0.07644105,
		0.07508445,
		0.07373941,
		0.07240653,
		0.07108581,
		0.06977761,
		0.06848216,
		0.06719983,
		0.06593049,
		0.06467450,
		0.06343222,
		0.06220353,
		0.06098866,
		0.05978799,
		0.05860138,
		0.05742908,
		0.05627120,
		0.05512774,
		0.05399883,
		0.05288458,
		0.05178511,
		0.05070043,
		0.04963064,
		0.04857564,
		0.04753554,
		0.04651034,
		0.04550028,
		0.04450500,
		0.04352474,
		0.04255927,
		0.04160881,
		0.04067326,
		0.03975248,
		0.03884649,
		0.03795528,
		0.03707886,
		0.03621697,
		0.03536987,
		0.03453708,
		0.03371859,
		0.03291464,
		0.03212476,
		0.03134918,
		0.03058767,
		0.02983999,
		0.02910614,
		0.02838612,
		0.02767968,
		0.02698660,
		0.02630687,
		0.02564049,
		0.02498722,
		0.02434683,
		0.02371931,
		0.02310467,
		0.02250242,
		0.02191234,
		0.02133489,
		0.02076936,
		0.02021575,
		0.01967406,
		0.01914406,
		0.01862550,
		0.01811814,
		0.01762223,
		0.01713729,
		0.01666307,
		0.01619959,
		0.01574683,
		0.01530433,
		0.01487184,
		0.01444983,
		0.01403761,
		0.01363492,
		0.01324201,
		0.01285839,
		0.01248431,
		0.01211905,
		0.01176310,
		0.01141548,
		0.01107669,
		0.01074648,
		0.01042438,
		0.01011062,
		0.00980473,
		0.00950694,
		0.00921679,
		0.00893402,
		0.00865889,
		0.00839067,
		0.00812984,
		0.00787592,
		0.00762868,
		0.00738811,
		0.00715446,
		0.00692677,
		0.00670552,
		0.00649047,
		0.00628138,
		0.00607824,
		0.00588059,
		0.00568867,
		0.00550222,
		0.00532079,
		0.00514507,
		0.00497413,
		0.00480843,
		0.00464725,
		0.00449109,
		0.00433946,
		0.00419235,
		0.00404978
};


